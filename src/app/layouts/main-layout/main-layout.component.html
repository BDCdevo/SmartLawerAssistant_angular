<!-- Global Loading Indicator -->
<app-global-loading></app-global-loading>

<!-- Sidebar -->
<aside class="sidebar" [class.open]="sidebarOpen()" (mouseenter)="onSidebarEnter()" (mouseleave)="onSidebarLeave()" (click)="$event.stopPropagation()">
  <header class="sidebar-header">
    @if (sidebarOpen()) {
      <img [src]="logoPath" alt="Smart Lawyer" class="logo-img">
      <span class="logo-text">Smart Lawyer</span>
    } @else {
      <img [src]="logoPath" alt="Smart Lawyer" class="logo-img">
    }
  </header>

  <nav class="sidebar-nav">
    @for (item of menuItems(); track item.route) {
      <a
        [routerLink]="item.route"
        routerLinkActive="active"
        class="nav-item"
        [title]="item.label"
        (click)="closeSidebarOnMobile()"
      >
        <span class="nav-icon">{{ item.icon }}</span>
        <span class="nav-label">{{ item.label }}</span>
      </a>
    }
  </nav>
</aside>

<!-- Main Content -->
<main class="main-content">
  <!-- Header -->
  <header class="top-header">
    <button class="menu-toggle" (click)="toggleSidebar()">â˜°</button>
    <h2 class="page-title">{{ userFullName() }}</h2>

    <div class="header-actions">
      <!-- Theme Toggle -->
      <button
        class="icon-btn theme-toggle"
        (click)="themeService.toggleTheme()"
        [title]="themeService.isDark() ? 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­' : 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†'"
      >
        @if (themeService.isDark()) {
          â˜€ï¸
        } @else {
          ğŸŒ™
        }
      </button>

      <!-- Notifications -->
      <button class="icon-btn" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª">
        <span class="badge">3</span>
        ğŸ””
      </button>

      <!-- User Menu -->
      <div class="user-menu-wrap">
        <button class="user-avatar" (click)="toggleUserMenu()">
          {{ userInitials() }}
        </button>

        @if (userMenuOpen()) {
          <div class="user-menu">
            <header class="user-menu-header">
              <div class="user-avatar-large">{{ userInitials() }}</div>
              <div class="user-info">
                <div class="user-name">{{ userFullName() }}</div>
                <div class="user-email">{{ userEmail() }}</div>
                @if (userRole()) {
                  <div class="user-role">{{ userRole() }}</div>
                }
              </div>
            </header>

            <nav class="user-menu-nav">
              <a routerLink="/profile" class="menu-item" (click)="toggleUserMenu()">
                <span>ğŸ‘¤</span> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
              </a>
              <a routerLink="/settings" class="menu-item" (click)="toggleUserMenu()">
                <span>âš™ï¸</span> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
              </a>
              <button class="menu-item logout" (click)="logout()">
                <span>ğŸšª</span> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
              </button>
            </nav>
          </div>
        }
      </div>
    </div>
  </header>

  <!-- Page Content -->
  <div class="page-content">
    <router-outlet></router-outlet>
  </div>
</main>

<!-- Overlay for Mobile -->
@if (sidebarOpen() && isMobile()) {
  <div class="overlay" (click)="closeSidebarOnMobile()"></div>
}
