<div class="courts-container" dir="rtl">
  <!-- Compact Header -->
  <div class="page-header-compact">
    <h1 class="header-title">ุฅุฏุงุฑุฉ ุงููุญุงูู</h1>
    <div class="header-actions">
      <button class="action-btn btn-secondary" (click)="loadCourts()" [disabled]="loading()">
        <span class="btn-icon" [class.spinning]="loading()">๐</span>
        <span>ุชุญุฏูุซ</span>
      </button>
      <button class="action-btn btn-primary" (click)="openCreateModal()">
        <span class="btn-icon">โ</span>
        <span>ุฅุถุงูุฉ ูุญููุฉ ุฌุฏูุฏุฉ</span>
      </button>
    </div>
  </div>

  <!-- Compact Filters - Single Row -->
  <div class="filters-compact">
    <div class="search-group">
      <input
        type="text"
        [value]="searchTerm()"
        (input)="searchTerm.set($any($event.target).value)"
        placeholder="๐ ุงุจุญุซ ูู ุงููุญุงูู..."
      />
    </div>
    <div class="filter-group">
      <input
        type="text"
        [value]="filterGovernorate()"
        (input)="filterGovernorate.set($any($event.target).value)"
        placeholder="ุงููุญุงูุธุฉ"
      />
    </div>
    <div class="filter-group">
      <input
        type="text"
        [value]="filterCity()"
        (input)="filterCity.set($any($event.target).value)"
        placeholder="ุงููุฏููุฉ"
      />
    </div>
    <button class="search-btn" (click)="loadCourts()">ุจุญุซ</button>
  </div>

  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>ุฌุงุฑู ุชุญููู ุงููุญุงูู...</p>
    </div>
  }

  <!-- Courts Table -->
  @if (!loading()) {
    @if (courts().length > 0) {
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>ุงูุงุณู ุจุงูุนุฑุจูุฉ</th>
              <th>ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ</th>
              <th>ุงููุญุงูุธุฉ</th>
              <th>ุงููุฏููุฉ</th>
              <th>ุงููุงุชู</th>
              <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
              <th>ุงูุญุงูุฉ</th>
              <th>ุงูุฅุฌุฑุงุกุงุช</th>
            </tr>
          </thead>
          <tbody>
            @for (court of courts(); track court.id) {
              <tr>
                <td>{{ court.id }}</td>
                <td>
                  <div class="court-name">{{ court.nameAr }}</div>
                </td>
                <td>{{ court.nameEn || '-' }}</td>
                <td>{{ court.governorate || '-' }}</td>
                <td>{{ court.city || '-' }}</td>
                <td>{{ court.phone || '-' }}</td>
                <td>{{ court.email || '-' }}</td>
                <td>
                  <span class="status-badge" [class.active]="court.isActive" [class.inactive]="!court.isActive">
                    {{ court.isActive ? 'ูุดุท' : 'ุบูุฑ ูุดุท' }}
                  </span>
                </td>
                <td class="actions-cell">
                  <button class="action-btn btn-edit" (click)="openEditModal(court)" title="ุชุนุฏูู">โ๏ธ</button>
                  <button class="action-btn btn-delete" (click)="delete(court.id)" title="ุญุฐู">๐๏ธ</button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

        <!-- Pagination -->
        @if (totalPages > 1) {
          <div class="pagination-container">
            <div class="pagination-info">
              ุนุฑุถ <strong>{{ (currentPage() - 1) * pageSize() + 1 }}</strong> -
              <strong>{{ Math.min(currentPage() * pageSize(), totalItems()) }}</strong>
              ูู <strong>{{ totalItems() }}</strong> ูุญููุฉ
            </div>
            <div class="pagination-controls">
              <button class="page-btn prev-btn" (click)="currentPage.set(currentPage() - 1); loadCourts()" [disabled]="currentPage() === 1">
                ุงูุณุงุจู
              </button>
              <button class="page-btn next-btn" (click)="currentPage.set(currentPage() + 1); loadCourts()" [disabled]="currentPage() === totalPages">
                ุงูุชุงูู
              </button>
            </div>
          </div>
        }
    } @else {
      <!-- Empty State -->
      <div class="empty-state">
        <div class="empty-icon">๐๏ธ</div>
        <h3 class="empty-title">ูุง ุชูุฌุฏ ูุญุงูู</h3>
        <p class="empty-message">ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃู ูุญุงูู. ูู ุจุฅุถุงูุฉ ูุญููุฉ ุฌุฏูุฏุฉ ููุจุฏุก.</p>
        <button class="action-btn btn-primary" (click)="openCreateModal()">
          <span class="btn-icon">โ</span>
          <span>ุฅุถุงูุฉ ูุญููุฉ ุฌุฏูุฏุฉ</span>
        </button>
      </div>
    }
  }
</div>

<!-- Create/Edit Modal -->
@if (showModal()) {
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" dir="rtl">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto m-4">
      <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
        <h2 class="text-xl font-bold text-gray-800">{{ isEditMode() ? 'ุชุนุฏูู' : 'ุฅุถุงูุฉ' }} ูุญููุฉ</h2>
        <button (click)="closeModal()" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Arabic Name -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">
              ุงูุงุณู ุจุงูุนุฑุจูุฉ <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              [value]="formData().nameAr"
              (input)="updateField('nameAr', $any($event.target).value)"
              placeholder="ุฃุฏุฎู ุงุณู ุงููุญููุฉ ุจุงูุนุฑุจูุฉ"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            />
          </div>

          <!-- English Name -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">
              ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ
            </label>
            <input
              type="text"
              [value]="formData().nameEn"
              (input)="updateField('nameEn', $any($event.target).value)"
              placeholder="ุฃุฏุฎู ุงุณู ุงููุญููุฉ ุจุงูุฅูุฌููุฒูุฉ"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Governorate -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุญุงูุธุฉ</label>
            <input
              type="text"
              [value]="formData().governorate"
              (input)="updateField('governorate', $any($event.target).value)"
              placeholder="ุงุณู ุงููุญุงูุธุฉ"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- City -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุฏููุฉ</label>
            <input
              type="text"
              [value]="formData().city"
              (input)="updateField('city', $any($event.target).value)"
              placeholder="ุงุณู ุงููุฏููุฉ"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Address -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุนููุงู</label>
            <input
              type="text"
              [value]="formData().addressLine"
              (input)="updateField('addressLine', $any($event.target).value)"
              placeholder="ุงูุนููุงู ุงูุชูุตููู"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Phone -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุงุชู</label>
            <input
              type="tel"
              [value]="formData().phone"
              (input)="updateField('phone', $any($event.target).value)"
              placeholder="ุฑูู ุงููุงุชู"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Email -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input
              type="email"
              [value]="formData().email"
              (input)="updateField('email', $any($event.target).value)"
              placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Active Status -->
          <div class="md:col-span-2">
            <label class="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                [checked]="formData().isActive"
                (change)="updateField('isActive', $any($event.target).checked)"
                class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
              />
              <span class="text-sm font-medium text-gray-700">ูุญููุฉ ูุดุทุฉ</span>
            </label>
          </div>
        </div>
      </div>

      <div class="sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end gap-3">
        <button
          (click)="closeModal()"
          class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors"
        >
          ุฅูุบุงุก
        </button>
        <button
          (click)="save()"
          [disabled]="loading()"
          class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 transition-colors"
        >
          {{ loading() ? 'ุฌุงุฑู ุงูุญูุธ...' : 'ุญูุธ' }}
        </button>
      </div>
    </div>
  </div>
}
