<div class="page-container">
  <!-- Compact Header -->
  <div class="page-header-compact">
    <h1 class="header-title">ุฅุฏุงุฑุฉ ุงูุนููุงุก</h1>
    <div class="header-actions">
      <button class="action-btn btn-secondary" (click)="loadClients()" [disabled]="loading()">
        <span class="btn-icon" [class.spinning]="loading()">๐</span>
        <span>ุชุญุฏูุซ</span>
      </button>
      <button class="action-btn btn-primary" (click)="openCreateModal()">
        <span class="btn-icon">โ</span>
        <span>ุฅุถุงูุฉ ุนููู</span>
      </button>
    </div>
  </div>

  <!-- Compact Filters - Single Row -->
  <div class="filters-compact">
    <div class="search-group">
      <input type="text" placeholder="๐ ุจุญุซ ุนู ุนููู..." [value]="searchQuery()" (input)="searchQuery.set($any($event.target).value); loadClients()">
    </div>
  </div>

  @if (loading()) {
    <div class="loading"><div class="spinner"></div><p>ุฌุงุฑู ุชุญููู ุงูุนููุงุก...</p></div>
  }

  @if (!loading()) {
    <table class="data-table">
      <thead>
        <tr>
          <th>#</th>
          <th>ุงูุงุณู ุงููุงูู</th>
          <th>ุงูุฑูู ุงููููู</th>
          <th>ุงููุงุชู</th>
          <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
          <th>ุงูุฌูุณ</th>
          <th>ุงููููุฉ</th>
          <th>ุงูุญุงูุฉ</th>
          <th>ุงูุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        @if (clients().length === 0) {
          <tr>
            <td colspan="9" class="empty-cell">
              <div class="empty-state">
                <span class="empty-icon">๐ฅ</span>
                <p>ูุง ููุฌุฏ ุนููุงุก</p>
              </div>
            </td>
          </tr>
        }
        @for (client of clients(); track client.id) {
          <tr [class.deleted-row]="!client.isActive">
            <td>{{ client.id }}</td>
            <td class="name-cell">{{ client.fullName }}</td>
            <td>{{ client.nationalId || '-' }}</td>
            <td>{{ client.phone || '-' }}</td>
            <td>{{ client.email || '-' }}</td>
            <td>{{ client.gender === 'Male' ? 'ุฐูุฑ' : (client.gender === 'Female' ? 'ุฃูุซู' : '-') }}</td>
            <td>{{ client.profession || '-' }}</td>
            <td><span [class]="client.isActive ? 'badge-active' : 'badge-inactive'">{{ client.isActive ? 'ูุดุท' : 'ุบูุฑ ูุดุท' }}</span></td>
            <td class="actions-cell">
              <button class="action-btn btn-edit" (click)="openEditModal(client)" title="ุชุนุฏูู">โ๏ธ</button>
              @if (client.isActive) {
                <button class="action-btn btn-delete" (click)="delete(client.id, client.fullName)" title="ุญุฐู">๐๏ธ</button>
              } @else {
                <button class="action-btn btn-restore" (click)="restore(client.id)" title="ุงุณุชุฑุฌุงุน">โป๏ธ</button>
              }
            </td>
          </tr>
        }
      </tbody>
    </table>

    @if (totalPages > 1) {
      <div class="pagination-container">
        <div class="pagination-info">
          ุนุฑุถ <strong>{{ (currentPage() - 1) * pageSize() + 1 }}</strong> -
          <strong>{{ Math.min(currentPage() * pageSize(), totalItems()) }}</strong>
          ูู <strong>{{ totalItems() }}</strong> ุนููู
        </div>
        <div class="pagination-controls">
          <button class="page-btn prev-btn" (click)="previousPage()" [disabled]="currentPage() === 1">ุงูุณุงุจู</button>
          @for (page of pages; track page) {
            <button class="page-btn" [class.active]="page === currentPage()" (click)="goToPage(page)">{{ page }}</button>
          }
          <button class="page-btn next-btn" (click)="nextPage()" [disabled]="currentPage() === totalPages">ุงูุชุงูู</button>
        </div>
      </div>
    }
  }

  @if (showModal()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ isEditMode() ? 'ุชุนุฏูู ุนููู' : 'ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ' }}</h2>
          <button (click)="closeModal()">โ</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>ุงูุงุณู ุงููุงูู *</label>
            <input type="text" [value]="formData().fullName" (input)="updateField('fullName', $any($event.target).value)" placeholder="ุงูุงุณู ุงููุงูู">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>ุงูุฑูู ุงููููู</label>
              <input type="number" [value]="formData().nationalId" (input)="updateField('nationalId', +$any($event.target).value || undefined)" placeholder="ุงูุฑูู ุงููููู">
            </div>
            <div class="form-group">
              <label>ุงููุงุชู</label>
              <input type="text" [value]="formData().phone" (input)="updateField('phone', $any($event.target).value)" placeholder="ุฑูู ุงููุงุชู">
            </div>
          </div>
          <div class="form-group">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" [value]="formData().email" (input)="updateField('email', $any($event.target).value)" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู">
          </div>
          <div class="form-group">
            <label>ุงูุนููุงู</label>
            <textarea rows="2" [value]="formData().address" (input)="updateField('address', $any($event.target).value)" placeholder="ุงูุนููุงู ุงููุงูู"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>ุงูุฌูุณ</label>
              <select [value]="formData().gender" (change)="updateField('gender', $any($event.target).value)">
                @for (option of genderOptions; track option.value) {
                  <option [value]="option.value">{{ option.label }}</option>
                }
              </select>
            </div>
            <div class="form-group">
              <label>ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ</label>
              <select [value]="formData().maritalStatus" (change)="updateField('maritalStatus', $any($event.target).value)">
                @for (option of maritalStatusOptions; track option.value) {
                  <option [value]="option.value">{{ option.label }}</option>
                }
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>ุงููููุฉ</label>
            <input type="text" [value]="formData().profession" (input)="updateField('profession', $any($event.target).value)" placeholder="ุงููููุฉ">
          </div>
          <div class="form-group">
            <label>ุชุงุฑูุฎ ุงููููุงุฏ</label>
            <input type="date" [value]="formData().dateOfBirth" (input)="updateField('dateOfBirth', $any($event.target).value)">
          </div>
          @if (isEditMode()) {
            <div class="form-group">
              <label><input type="checkbox" [checked]="formData().isActive" (change)="updateField('isActive', $any($event.target).checked)"> ูุดุท</label>
            </div>
          }
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" (click)="closeModal()">ุฅูุบุงุก</button>
          <button class="btn-primary" (click)="save()" [disabled]="loading()">{{ loading() ? 'ุฌุงุฑู ุงูุญูุธ...' : 'ุญูุธ' }}</button>
        </div>
      </div>
    </div>
  }
</div>
