<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>ููุญุฉ ุงูุชุญูู</h1>
      <p>ูุฑุญุจุงู ุจู ูู ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุจ ุงููุงูููู</p>
    </div>
    <button class="refresh-btn" (click)="loadDashboardData()" [disabled]="loading()">
      <span class="refresh-icon">๐</span>
      ุชุญุฏูุซ ุงูุจูุงูุงุช
    </button>
  </div>

  @if (loading()) {
    <div class="loading-overlay">
      <div class="spinner-container">
        <div class="spinner"></div>
        <p>ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</p>
      </div>
    </div>
  }

  @if (error()) {
    <div class="error-message">
      <span class="error-icon">โ๏ธ</span>
      <div class="error-content">
        <h3>ุญุฏุซ ุฎุทุฃ</h3>
        <p>{{ error() }}</p>
      </div>
      <button class="retry-btn" (click)="loadDashboardData()">ุฅุนุงุฏุฉ ุงููุญุงููุฉ</button>
    </div>
  }

  @if (!loading() && !error()) {
    <!-- Key Statistics Cards -->
    <div class="stats-grid">
      <div class="stat-card primary">
        <div class="stat-header">
          <div class="stat-icon">โ๏ธ</div>
          <span class="stat-badge">+12%</span>
        </div>
        <div class="stat-body">
          <h3 class="stat-value">{{ stats().totalCases }}</h3>
          <p class="stat-label">ุฅุฌูุงูู ุงููุถุงูุง</p>
          <div class="stat-footer">
            <span class="stat-detail">{{ stats().activeCases }} ูุดุทุฉ</span>
          </div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-header">
          <div class="stat-icon">โ</div>
          <span class="stat-badge success">+8%</span>
        </div>
        <div class="stat-body">
          <h3 class="stat-value">{{ stats().closedCases }}</h3>
          <p class="stat-label">ุงููุถุงูุง ุงููุบููุฉ</p>
          <div class="stat-footer">
            <span class="stat-detail">{{ stats().pendingCases }} ูุนููุฉ</span>
          </div>
        </div>
      </div>

      <div class="stat-card info">
        <div class="stat-header">
          <div class="stat-icon">๐ฅ</div>
          <span class="stat-badge info">+5%</span>
        </div>
        <div class="stat-body">
          <h3 class="stat-value">{{ stats().totalClients }}</h3>
          <p class="stat-label">ุฅุฌูุงูู ุงูุนููุงุก</p>
          <div class="stat-footer">
            <span class="stat-detail">ูุดุท ูุฐุง ุงูุดูุฑ</span>
          </div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-header">
          <div class="stat-icon">๐</div>
          <span class="stat-badge warning">ูุฑูุจุงู</span>
        </div>
        <div class="stat-body">
          <h3 class="stat-value">{{ stats().upcomingHearings }}</h3>
          <p class="stat-label">ุงูุฌูุณุงุช ุงููุงุฏูุฉ</p>
          <div class="stat-footer">
            <span class="stat-detail">ุฎูุงู 7 ุฃูุงู</span>
          </div>
        </div>
      </div>

      <div class="stat-card document">
        <div class="stat-header">
          <div class="stat-icon">๐</div>
          <span class="stat-badge">ุฌุฏูุฏ</span>
        </div>
        <div class="stat-body">
          <h3 class="stat-value">{{ stats().totalDocuments }}</h3>
          <p class="stat-label">ุงููุณุชูุฏุงุช</p>
          <div class="stat-footer">
            <span class="stat-detail">ูู ุงููุธุงู</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts and Statistics Section -->
    <div class="charts-grid">
      <!-- Cases by Status -->
      <div class="chart-card">
        <div class="card-header">
          <h2>ุชูุฒูุน ุงููุถุงูุง ุญุณุจ ุงูุญุงูุฉ</h2>
          <button class="icon-btn">๐</button>
        </div>
        <div class="card-content">
          @if (stats().casesByStatus && stats().casesByStatus.length > 0) {
            <div class="status-distribution">
              @for (item of stats().casesByStatus; track item.status) {
                <div class="status-item">
                  <div class="status-bar-container">
                    <div class="status-bar-header">
                      <span class="status-name">{{ getStatusLabel(item.status) }}</span>
                      <span class="status-count">{{ item.count }}</span>
                    </div>
                    <div class="status-bar">
                      <div
                        class="status-bar-fill"
                        [style.width.%]="item.percentage"
                        [style.background-color]="getStatusColor(item.status)">
                      </div>
                    </div>
                    <span class="status-percentage">{{ item.percentage }}%</span>
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-chart">
              <p>ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</p>
            </div>
          }
        </div>
      </div>

      <!-- Cases by Priority -->
      <div class="chart-card">
        <div class="card-header">
          <h2>ุชูุฒูุน ุงููุถุงูุง ุญุณุจ ุงูุฃููููุฉ</h2>
          <button class="icon-btn">๐ฏ</button>
        </div>
        <div class="card-content">
          @if (stats().casesByPriority && stats().casesByPriority.length > 0) {
            <div class="priority-grid">
              @for (item of stats().casesByPriority; track item.priority) {
                <div class="priority-card" [style.border-color]="getPriorityColor(item.priority)">
                  <div class="priority-header">
                    <h4>{{ getPriorityLabel(item.priority) }}</h4>
                  </div>
                  <div class="priority-value" [style.color]="getPriorityColor(item.priority)">
                    {{ item.count }}
                  </div>
                  <div class="priority-percentage">
                    {{ item.percentage }}%
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-chart">
              <p>ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</p>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Recent Activities and Quick Actions -->
    <div class="content-grid">
      <!-- Recent Activities -->
      <div class="activity-card">
        <div class="card-header">
          <h2>ุงูุฃูุดุทุฉ ุงูุฃุฎูุฑุฉ</h2>
          <a routerLink="/activity-log" class="view-all-link">ุนุฑุถ ุงููู โ</a>
        </div>
        <div class="card-content">
          @if (recentActivities() && recentActivities().length > 0) {
            <div class="activities-timeline">
              @for (activity of recentActivities(); track activity.id) {
                <div class="activity-item">
                  <div class="activity-icon-wrapper">
                    <span class="activity-icon">{{ getActivityIcon(activity.type) }}</span>
                  </div>
                  <div class="activity-content">
                    <div class="activity-header">
                      <span class="activity-type">{{ getActivityTypeLabel(activity.type) }}</span>
                      <span class="activity-time">{{ getTimeAgo(activity.timestamp) }}</span>
                    </div>
                    <p class="activity-description">{{ activity.description }}</p>
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-state">
              <span class="empty-icon">๐ญ</span>
              <p>ูุง ุชูุฌุฏ ุฃูุดุทุฉ ุญุฏูุซุฉ</p>
            </div>
          }
        </div>
      </div>

      <!-- Quick Actions Panel -->
      <div class="actions-card">
        <div class="card-header">
          <h2>ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h2>
        </div>
        <div class="card-content">
          <div class="quick-actions-grid">
            <a routerLink="/cases/new" class="action-card">
              <div class="action-icon primary">โ๏ธ</div>
              <h3>ูุถูุฉ ุฌุฏูุฏุฉ</h3>
              <p>ุฅุถุงูุฉ ูุถูุฉ ุฌุฏูุฏุฉ ูููุธุงู</p>
            </a>

            <a routerLink="/clients/new" class="action-card">
              <div class="action-icon success">๐ค</div>
              <h3>ุนููู ุฌุฏูุฏ</h3>
              <p>ุชุณุฌูู ุนููู ุฌุฏูุฏ</p>
            </a>

            <a routerLink="/documents/upload" class="action-card">
              <div class="action-icon info">๐</div>
              <h3>ุฑูุน ูุณุชูุฏ</h3>
              <p>ุฅุถุงูุฉ ูุณุชูุฏ ุฌุฏูุฏ</p>
            </a>

            <a routerLink="/ai-assistant" class="action-card">
              <div class="action-icon warning">๐ค</div>
              <h3>ุงููุณุงุนุฏ ุงูุฐูู</h3>
              <p>ุงุณุชุดุงุฑุฉ ูุงููููุฉ ุฐููุฉ</p>
            </a>

            <a routerLink="/appointments/new" class="action-card">
              <div class="action-icon document">๐</div>
              <h3>ุญุฌุฒ ููุนุฏ</h3>
              <p>ุฌุฏููุฉ ููุนุฏ ุฌุฏูุฏ</p>
            </a>

            <a routerLink="/reports" class="action-card">
              <div class="action-icon primary">๐</div>
              <h3>ุงูุชูุงุฑูุฑ</h3>
              <p>ุนุฑุถ ุงูุชูุงุฑูุฑ ุงูุชูุตูููุฉ</p>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Monthly Statistics -->
    @if (stats().monthlyStats && stats().monthlyStats.length > 0) {
      <div class="monthly-stats-card">
        <div class="card-header">
          <h2>ุงูุฅุญุตุงุฆูุงุช ุงูุดูุฑูุฉ</h2>
          <button class="export-btn">
            <span>๐ฅ</span>
            ุชุตุฏูุฑ
          </button>
        </div>
        <div class="card-content">
          <div class="monthly-stats-grid">
            @for (stat of stats().monthlyStats; track stat.month + stat.year) {
              <div class="monthly-stat-item">
                <div class="month-header">
                  <h4>{{ stat.month }} {{ stat.year }}</h4>
                </div>
                <div class="month-stats">
                  <div class="month-stat">
                    <span class="stat-label">ูุถุงูุง ุฌุฏูุฏุฉ</span>
                    <span class="stat-value">{{ stat.totalCases }}</span>
                  </div>
                  <div class="month-stat">
                    <span class="stat-label">ูุถุงูุง ูุบููุฉ</span>
                    <span class="stat-value success">{{ stat.closedCases }}</span>
                  </div>
                  @if (stat.revenue) {
                    <div class="month-stat">
                      <span class="stat-label">ุงูุฅูุฑุงุฏุงุช</span>
                      <span class="stat-value primary">{{ stat.revenue }} ุฌ.ู</span>
                    </div>
                  }
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    }
  }
</div>
